newtype State s a = State
  { runState :: s -> (a, s) }

-----------------------------------------------------------------------------
-- 1.
get :: State s s
get = State $ \x -> (x, x)

-----------------------------------------------------------------------------
-- 2.
put :: s -> State s ()
put x = State $ \_ -> ((), x)

-----------------------------------------------------------------------------
-- 3.
exec :: State s a -> s -> s
exec (State sa) s = snd $ runState (State $ \_ -> sa s) s

-----------------------------------------------------------------------------
-- 4.
eval :: State s a -> s -> a
eval (State sa) = \x -> fst $ sa x

-----------------------------------------------------------------------------
-- 5.
modify :: (s -> s) -> State s ()
modify = \f -> State $ \x -> ((), f x)
